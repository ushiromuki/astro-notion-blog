---
import katex from 'katex'
import type { RichText } from '../../lib/interfaces.ts'
import Mention from './Mention'
import Anchor from './annotations/Anchor'
import Bold from './annotations/Bold'
import Code from './annotations/Code'
import Color from './annotations/Color'
import Italic from './annotations/Italic'
import Strikethrough from './annotations/Strikethrough'
import Underline from './annotations/Underline'

export interface Props {
  richText: RichText
}

const { richText } = Astro.props
---

<Anchor richText={richText} client:only="react">
  {
    (
      <Code richText={richText} client:only="react">
        {
          <Color richText={richText} client:only="react">
            {
              <Underline richText={richText} client:only="react">
                {
                  <Strikethrough richText={richText} client:only="react">
                    {
                      <Italic richText={richText} client:only="react">
                        {
                          <Bold richText={richText} client:only="react">
                            {
                              richText.Text ? 
                                richText.Text.Content :
                              richText.Mention ? 
                                <Mention richText={richText} client:only="react" /> :
                              richText.Equation ? 
                                <span
                                  set:html={katex.renderToString(richText.Equation.Expression, {
                                    throwOnError: false,
                                    output: 'html',
                                  })}
                                /> :
                              richText.Href ? 
                                richText.Href : 
                                'ã€€'
                            }
                          </Bold>
                        }
                      </Italic>
                    }
                  </Strikethrough>
                }
              </Underline>
            }
          </Color>
        }
      </Code>
    )
  }
</Anchor>
